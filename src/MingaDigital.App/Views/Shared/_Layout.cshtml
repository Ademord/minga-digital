@using System.Collections.Generic
@inject MingaDigital.App.Services.UserSessionService UserSession

<!DOCTYPE html>
<html>
<head>
  <title>@ViewBag.Title – Minga Digital</title>
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  
  <script src="/bower_components/jquery/dist/jquery.min.js"></script>
  
  <link rel="stylesheet" href="/bower_components/bootstrap/dist/css/bootstrap.min.css">
  <script src="/bower_components/bootstrap/dist/js/bootstrap.min.js"></script>

  <link rel="stylesheet" href="/css/main.css">
  
  <link rel="stylesheet" href="/css/typeahead.css">
  <script src="/lib/typeahead.bundle.min.js"></script>
  
  <script>
    // TODO mover a un lugar mejor
    $(window).ready(function () {
      $('a.row-link').each(function () {
        var link = $(this);
        
        link.parents('tr').css('cursor', 'pointer').click(function () {
          window.location = link.attr('href');
        });
      });
    });
  </script>
</head>
<body>

<nav class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="@Url.Action("Index", "Home")">Minga Digital</a>
    </div>
    <div class="collapse navbar-collapse" id="main-navbar">
      @if (UserSession.IsLoggedIn)
      {
        var personUrl =
          Url.Action(
            "Detail",
            "PersonaFisica",
            new { id = UserSession.ActiveUser.PersonaFisica.PersonaFisicaId }
          );
        
        <div class="navbar-right">
          Hola,
          <a href="@personUrl" class="navbar-link">
            @UserSession.ActiveUser.PersonaFisica.Nombre
          </a>
          <a href="@Url.Action("Logout", "Usuario")" class="btn btn-default navbar-btn">
            <span class="glyphicon glyphicon-log-out"></span>
            Salir
          </a>
        </div>
      }
      
      <ul class="nav navbar-nav">
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button">
            Establecimientos <span class="caret"></span>
          </a>
          
          <ul class="dropdown-menu" role="menu">
            <li><a href="@Url.Action("Index", "Telecentro")">Telecentros</a></li>
            <li><a href="@Url.Action("Index", "Almacen")">Almacenes</a></li>
            <li class="divider"></li>
            <li><a href="@Url.Action("Index", "Ubicacion")">Ubicaciones</a></li>
          </ul>
        </li>
        
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button">
            Personas <span class="caret"></span>
          </a>
          
          <ul class="dropdown-menu" role="menu">
            <li><a href="@Url.Action("Index", "PersonaJuridica")">Personas Jurídicas</a></li>
            <li><a href="@Url.Action("Index", "PersonaFisica")">Personas Físicas</a></li>
            <li class="divider"></li>
            <li><a href="@Url.Action("Index", "Rol")">Roles</a></li>
          </ul>
        </li>
        
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button">
            Actividades <span class="caret"></span>
          </a>
          
          <ul class="dropdown-menu" role="menu">
            <li><a href="@Url.Action("Index", "Actividad")">Actividades</a></li>
            <li class="divider"></li>
            <li><a href="@Url.Action("Index", "TipoActividad")">Tipos de Actividad</a></li>
          </ul>
        </li>
        
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button">
            Incidencias <span class="caret"></span>
          </a>
          
          <ul class="dropdown-menu" role="menu">
            <li><a href="@Url.Action("Index", "Incidencia")">Incidencias</a></li>
            <li class="divider"></li>
            <li><a href="@Url.Action("Index", "TipoIncidencia")">Tipos de Incidencia</a></li>
          </ul>
        </li>
        
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button">
            Configuración <span class="caret"></span>
          </a>
          
          <ul class="dropdown-menu" role="menu">
            <li><a href="@Url.Action("Index", "Rubro")">Rubros</a></li>
            <li><a href="@Url.Action("Index", "TipoEmpresa")">Tipos de Empresa</a></li>
          </ul>
        </li>
      </ul>
    </div>
  </div>
</nav>

<div id="main">
  <div class="container">

@RenderBody()

  </div>
</div>

<footer class="page-footer">
  <p>Desarrollado por alumnos UPSA, 2015 S1.</p>
  <p>Proyecto supervisado por Ing. Karem Infantas</p>
</footer>

</body>
</html>